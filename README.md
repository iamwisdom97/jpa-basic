# 자바 ORM 표준 JPA 프로그래밍 - 기본편

## JPA 시작하기
- H2 database 실행
- 라이브러리 셋팅
- persistence.xml 에 대해
- JPA는 항상 하나씩 EntityMangerFactory 띄워서 돌아간다.
- JPA는 요청이 올때마다 EntityManger 를 통해서 작업해야한다.
- JPA는 데이터 변경은 트랜잭션 안에서 일어나야 한다.
- commit 필수!
- 자원을 다 쓰면 닫아줘야 한다.
- was가 내려가면 EntityManagerFactory 를 닫아줘야한다.

## 영속성 관리 - 내부 동작 방식
- JPA에서 가장 중요한 2 가지
  - 객체와 관게형 데이터베이스 매핑하기
  - 영속성 컨텍스트 : 엔티티를 영구 저장하는 환경, 눈에 보이지 않는다.
- 엔티티 생명주기
  - 비영속, 영속, 준영속, 삭제
- 영속성 컨텍스트 장점
  - 1차 캐시(한 번 조회한거 또 한번 쿼리에서 조회하지 않음)
  - 동일성 보장
  - 트랜잭션을 지원하는 쓰기 지연
  - 변경 감지(update 자동 인식)
  - 지연 로딩(쿼리를 나중에 날림)
- 플러시 
  - 커밋이나 쿼리를 실행할 때 플러시(내가 직접 플러시 할 수 있다.)
  - 영속성 컨텍스트를 비우지 않음
  - 영속성 컨텍스트의 변경내용을 데이터베이스에 동기화
  - 트랜잭션이라는 작업 단위가 중요 -> 커밋 직전에만 동기화 하면 됨